#N canvas 174 73 735 739 12;
#X declare -path ./bop.p;
#X obj 20 130 bop.p.param \$0 fm;
#X obj 20 100 bop.p.number \$0 detune;
#X obj 477 647 savestate, f 17;
#X obj 476 620 bop.p.autosave \$0;
#X text 317 568 Other messages get picked up in the bop.p.param \, bop.p.toggle \, and bop.p.number objects, f 20;
#N canvas 592 37 860 891 fm 0;
#X obj 358 331 *~;
#X obj 274 112 +~;
#X obj 312 170 *~;
#X obj 272 218 +~;
#X obj 81 1231 outlet~;
#X obj 81 747 *~, f 14;
#X obj 81 463 osc~;
#X obj 81 366 +~, f 40;
#X obj 82 27 inlet~;
#X obj 81 326 *~;
#X obj 271 549 osc~ 0.5;
#X obj 271 674 *~;
#X obj 176 674 sig~ 1;
#X obj 176 710 -~, f 14;
#X obj 271 587 expr~ $v1 * 0.5 + 0.5;
#X obj 81 1181 *~;
#X obj 81 1041 *~, f 21;
#X obj 261 865 r \$0-velocity;
#X text 143 25 FM;
#X obj 691 181 mtof;
#X obj 691 141 unpack, f 10;
#X obj 758 193 s \$0-velocity;
#X obj 691 254 s \$0-set-frequency;
#X text 759 60 MIDI handling;
#X obj 273 52 r~ \$0-get-frequency;
#X obj 329 93 r~ \$0-get-detune;
#X obj 329 124 /~ 10000;
#X obj 429 159 r~ \$0-get-dividend;
#X obj 467 185 r~ \$0-get-divisor;
#X obj 428 226 /~, f 6;
#X obj 97 151 r~ \$0-get-fm;
#X obj 97 190 *~ 10;
#X obj 98 226 pow~ 4;
#X obj 271 475 r~ \$0-get-lfo-speed;
#X obj 271 498 pow~ 4;
#X obj 271 522 *~ 20;
#X obj 289 617 r~ \$0-get-lfo-depth;
#X obj 120 1146 r~ \$0-get-gain;
#X msg 691 218 \$1 0;
#X obj 691 54 inlet;
#X obj 711 103 outlet;
#X obj 261 898 bop.p.adsr~ \$0;
#X obj 97 939 expr~ 1 - $v1;
#X obj 243 939 *~;
#X obj 225 1004 +~;
#X obj 97 836 r \$0-get-envelope;
#X msg 97 862 \$1 5;
#X obj 97 888 line~;
#X connect 0 0 7 1;
#X connect 1 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 3 0 0 0;
#X connect 5 0 16 0;
#X connect 6 0 5 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X connect 9 0 7 0;
#X connect 10 0 14 0;
#X connect 11 0 13 1;
#X connect 12 0 13 0;
#X connect 13 0 5 1;
#X connect 14 0 11 0;
#X connect 15 0 4 0;
#X connect 16 0 15 0;
#X connect 17 0 41 0;
#X connect 19 0 38 0;
#X connect 20 0 19 0;
#X connect 20 1 21 0;
#X connect 24 0 1 0;
#X connect 25 0 26 0;
#X connect 26 0 2 1;
#X connect 27 0 29 0;
#X connect 28 0 29 1;
#X connect 29 0 0 1;
#X connect 30 0 31 0;
#X connect 31 0 32 0;
#X connect 32 0 9 1;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 35 0 10 0;
#X connect 36 0 11 1;
#X connect 37 0 15 1;
#X connect 38 0 22 0;
#X connect 39 0 20 0;
#X connect 39 0 40 0;
#X connect 41 0 43 1;
#X connect 42 0 44 0;
#X connect 43 0 44 1;
#X connect 44 0 16 1;
#X connect 45 0 46 0;
#X connect 46 0 47 0;
#X connect 47 0 43 0;
#X connect 47 0 42 0;
#X restore 307 337 pd fm;
#X f 12;
#X text 474 567 ... and are stored in here when the parent patch is saved, f 22;
#X obj 289 94 inlet~, f 12;
#X obj 567 341 outlet;
#X obj 289 403 outlet~;
#X text 295 434 Signal out of left, f 9;
#X obj 388 301 r \$0-midi-in;
#X obj 388 379 s \$0-midi-out;
#X obj 370 133 bop.p.inout \$0;
#X text 554 65 signal2 is FM;
#X text 273 62 midi and messages in;
#X text 579 367 dump midi and messages, f 13;
#X text 327 527 ---------- STATE SAVING ---------------, f 43;
#X obj 382 22 declare -path ./bop.p;
#X obj 289 371 +~;
#X obj 20 40 bop.p.number \$0 frequency 333;
#X obj 20 60 bop.p.number \$0 dividend 1;
#X obj 20 80 bop.p.number \$0 divisor 1;
#X obj 20 270 bop.p.param \$0 lfo-speed 0.25;
#X obj 20 290 bop.p.param \$0 lfo-depth 0;
#X obj 20 320 bop.p.param \$0 gain 0.75;
#X obj 559 95 inlet~ FM, f 12;
#X obj 20 180 bop.p.adsr-params \$0;
#X obj 93 160 bop.p.toggle \$0 envelope 1;
#X connect 2 0 3 1;
#X connect 2 1 3 0;
#X connect 3 0 2 0;
#X connect 5 0 19 1;
#X connect 5 1 12 0;
#X connect 7 0 19 0;
#X connect 7 1 13 0;
#X connect 11 0 5 1;
#X connect 13 0 8 0;
#X connect 19 0 9 0;
#X connect 26 0 5 0;
#X coords 0 -1 1 1 166 340 1 10 10;
